
# UDEMY

- Python Django: Ultimate Web Security Checklist - 2025, https://www.udemy.com/course/python-django-ultimate-web-security-checklist-2022/?utm_source=adwords&utm_medium=udemyads&utm_campaign=Search_DSA_Beta_Prof_la.EN_cc.ROW-English&campaigntype=Search&portfolio=ROW-English&language=EN&product=Course&test=&audience=DSA&topic=&priority=Beta&utm_content=deal4584&utm_term=_._ag_162511579404_._ad_696197165418_._kw__._de_c_._dm__._pl__._ti_dsa-1677053911088_._li_9061017_._pd__._&matchtype=&gad_source=1&gad_campaignid=21168154305&gbraid=0AAAAADROdO3jbv6dOu8GksfwkVYErrEvR&gclid=CjwKCAjw7_DEBhAeEiwAWKiCC1NnKeTkDUnSQc5l6ulJmKXKzDJN6zCglU9KERdfGgQcEbQ0fydlSxoCIcUQAvD_BwE&couponCode=PMNVD2525
- Secure by Design: Django Best Practices for Web Security, https://medium.com/@StartXLabs/secure-by-design-django-best-practices-for-web-security-b5a668921b47
- DjangoCon Europe 2023 | A Beginners Guide to Security Exploits in Action, https://www.youtube.com/watch?v=CN6zJlqdxt0
- 


- Django Security Best Practices: Essential Strategies for Protecting Your Web App - Joseph Adediji, https://www.youtube.com/watch?v=6KDyCW-B_f4
- Secure Coding in Python Django, https://www.udemy.com/course/secpy-django/?utm_source=adwords&utm_medium=udemyads&utm_campaign=Search_DSA_Beta_Prof_la.EN_cc.ROW-English&campaigntype=Search&portfolio=ROW-English&language=EN&product=Course&test=&audience=DSA&topic=&priority=Beta&utm_content=deal4584&utm_term=_._ag_162511579404_._ad_696197165418_._kw__._de_c_._dm__._pl__._ti_dsa-1677053911088_._li_9061017_._pd__._&matchtype=&gad_source=1&gad_campaignid=21168154305&gbraid=0AAAAADROdO3jbv6dOu8GksfwkVYErrEvR&gclid=CjwKCAjw7_DEBhAeEiwAWKiCC1X-GjWJwC_3AZdVk6vs9FfISSV_mDvaih8UehyOw4lvqv0IdbdWkxoCFBYQAvD_BwE&couponCode=PMNVD2525
- Django Security Cheat Sheet, https://cheatsheetseries.owasp.org/cheatsheets/Django_Security_Cheat_Sheet.html
- DJA201 ‚Äì Defending Django, https://www.securitycompass.com/training_courses/dja201-defending-django/
- Best Django security practices, https://escape.tech/blog/best-django-security-practices/
- Django web application security, https://developer.mozilla.org/en-US/docs/Learn_web_development/Extensions/Server-side/Django/web_application_security
- 




# –ü—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏ Django
## Security Best Practices –¥–ª—è Django –¥–æ–¥–∞—Ç–∫—ñ–≤

---

## –ß–æ–º—É –≤–∞–∂–ª–∏–≤–∞ –±–µ–∑–ø–µ–∫–∞?

### üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ñ–±–µ—Ä–∑–∞–≥—Ä–æ–∑:**
- **2023 —Ä—ñ–∫:** 2,300+ –∫—ñ–±–µ—Ä–∞—Ç–∞–∫ –∑ 343+ –º–ª–Ω –∂–µ—Ä—Ç–≤ –ø–æ –≤—Å—å–æ–º—É —Å–≤—ñ—Ç—É
- **72% –∑–±—ñ–ª—å—à–µ–Ω–Ω—è** –≤–∏—Ç–æ–∫—ñ–≤ –¥–∞–Ω–∏—Ö —É 2023 —Ä–æ—Ü—ñ
- **$4.4 –º–ª–Ω** - —Å–µ—Ä–µ–¥–Ω—è –≤–∞—Ä—Ç—ñ—Å—Ç—å –≤–∏—Ç–æ–∫—É –¥–∞–Ω–∏—Ö
- **Nigerian NIN/BVN data** –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞ —á–æ—Ä–Ω–æ–º—É —Ä–∏–Ω–∫—É –∑–∞ ‚Ç¶100

### üéØ **–ß–æ–º—É —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∏ —ñ–≥–Ω–æ—Ä—É—é—Ç—å –±–µ–∑–ø–µ–∫—É:**
```
‚ùå "–ì–æ–ª–æ–≤–Ω–µ, —â–æ–± –¥–æ–¥–∞—Ç–æ–∫ –ø—Ä–∞—Ü—é–≤–∞–≤"
‚ùå "–ë–µ–∑–ø–µ–∫–∞ - —Ü–µ –Ω–µ –º–æ—ó –ø—Ä–æ–±–ª–µ–º–∏"
‚ùå "–ù—ñ—Ö—Ç–æ –Ω–µ –±—É–¥–µ –∞—Ç–∞–∫—É–≤–∞—Ç–∏ –º—ñ–π –º–∞–ª–µ–Ω—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫"
‚ùå "–î–æ–¥–∞–º –±–µ–∑–ø–µ–∫—É –ø—ñ–∑–Ω—ñ—à–µ"
```

### üí∞ **–†–µ–∞–ª—å–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏:**
- **Twitter hack 2020:** $121,000 –≤—Ç—Ä–∞—á–µ–Ω–æ —á–µ—Ä–µ–∑ Bitcoin scam
- **–û—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ:** NIN, BVN, –∞–¥—Ä–µ—Å–∏, —Ñ–æ—Ç–æ - –≤—Å–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂
- **AI impersonation:** –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å—É —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å
- **–†–µ–ø—É—Ç–∞—Ü—ñ–π–Ω—ñ –≤—Ç—Ä–∞—Ç–∏** —Ç–∞ –ø—Ä–∞–≤–æ–≤—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏

---

## Authentication vs Authorization

### üîê **Authentication (–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è)**
**–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–æ–≥–æ, —â–æ –≤–∏ —î —Ç–∏–º, –∑–∞ –∫–æ–≥–æ —Å–µ–±–µ –≤–∏–¥–∞—î—Ç–µ.

**–ü—Ä–∏–∫–ª–∞–¥:**
```python
# Django authentication
from django.contrib.auth import authenticate, login

def login_view(request):
    if request.method == 'POST':
        username = request.POST['username']
        password = request.POST['password']
        
        # –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        user = authenticate(request, username=username, password=password)
        
        if user is not None:
            login(request, user)
            return redirect('dashboard')
        else:
            messages.error(request, '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É')
    
    return render(request, 'login.html')
```

### üõ°Ô∏è **Authorization (–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è)**
**–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ–∑–≤–æ–ª—ñ–≤ –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –¥—ñ–π.

**–ü—Ä–∏–∫–ª–∞–¥ LMS —Å–∏—Å—Ç–µ–º–∏:**
```python
from django.contrib.auth.decorators import login_required, user_passes_test
from django.contrib.auth.models import Group

def is_teacher(user):
    return user.groups.filter(name='Teachers').exists()

def is_student(user):
    return user.groups.filter(name='Students').exists()

@login_required
@user_passes_test(is_teacher)
def teacher_dashboard(request):
    """–¢—ñ–ª—å–∫–∏ –≤–∏–∫–ª–∞–¥–∞—á—ñ –º–æ–∂—É—Ç—å –±–∞—á–∏—Ç–∏ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É"""
    return render(request, 'teacher_dashboard.html')

@login_required
@user_passes_test(is_student)
def student_dashboard(request):
    """–¢—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å –±–∞—á–∏—Ç–∏ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É"""
    return render(request, 'student_dashboard.html')

@login_required
@user_passes_test(is_teacher)
def update_grades(request, student_id):
    """–¢—ñ–ª—å–∫–∏ –≤–∏–∫–ª–∞–¥–∞—á—ñ –º–æ–∂—É—Ç—å –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –æ—Ü—ñ–Ω–∫–∏"""
    if request.method == 'POST':
        # –õ–æ–≥—ñ–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –æ—Ü—ñ–Ω–æ–∫
        pass
```

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ proper authorization:**
```python
# –ù–ï–ë–ï–ó–ü–ï–ß–ù–û - –±—É–¥—å-—Ö—Ç–æ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø
def teacher_dashboard(request):
    # –ù–µ–º–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–æ–ª–µ–π!
    return render(request, 'teacher_dashboard.html')

# –°—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—ó –æ—Ü—ñ–Ω–∫–∏:
# GET /teacher/update-grades/123/
```

### üîí **–ü–æ–∫—Ä–∞—â–µ–Ω—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏:**

#### **Strong Password Policies:**
```python
# settings.py
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
        'OPTIONS': {
            'min_length': 12,  # –ú—ñ–Ω—ñ–º—É–º 12 —Å–∏–º–≤–æ–ª—ñ–≤
        }
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]

# Custom password validator
class CustomPasswordValidator:
    def validate(self, password, user=None):
        if not any(char.isdigit() for char in password):
            raise ValidationError("–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ —Ö–æ—á–∞ –± –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É")
        if not any(char.isupper() for char in password):
            raise ValidationError("–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ —Ö–æ—á–∞ –± –æ–¥–Ω—É –≤–µ–ª–∏–∫—É –ª—ñ—Ç–µ—Ä—É")
        if not any(char in "!@#$%^&*" for char in password):
            raise ValidationError("–ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏")
```

#### **Two-Factor Authentication:**
```python
# –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ django-otp
from django_otp.decorators import otp_required
from django_otp.plugins.otp_totp.models import TOTPDevice

@login_required
@otp_required
def sensitive_view(request):
    """–ü–æ—Ç—Ä–µ–±—É—î 2FA –¥–ª—è –¥–æ—Å—Ç—É–ø—É"""
    return render(request, 'sensitive_data.html')

def setup_2fa(request):
    """–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è 2FA –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
    device = TOTPDevice.objects.create(
        user=request.user,
        name='default'
    )
    return render(request, 'setup_2fa.html', {'qr_code': device.config_url})
```

#### **Session Management:**
```python
# settings.py
# Session timeout - 30 —Ö–≤–∏–ª–∏–Ω
SESSION_COOKIE_AGE = 1800  # 30 —Ö–≤–∏–ª–∏–Ω –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
SESSION_EXPIRE_AT_BROWSER_CLOSE = True
SESSION_SAVE_EVERY_REQUEST = True  # –û–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —á–∞—Å —Å–µ—Å—ñ—ó –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ

# Secure session cookies
SESSION_COOKIE_SECURE = True  # –¢—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ HTTPS
SESSION_COOKIE_HTTPONLY = True  # –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ JavaScript
SESSION_COOKIE_SAMESITE = 'Strict'  # CSRF –∑–∞—Ö–∏—Å—Ç

# Custom middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ logout
class SessionTimeoutMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        if request.user.is_authenticated:
            last_activity = request.session.get('last_activity')
            if last_activity:
                time_since_activity = timezone.now() - datetime.fromisoformat(last_activity)
                if time_since_activity.total_seconds() > 1800:  # 30 —Ö–≤–∏–ª–∏–Ω
                    logout(request)
                    messages.info(request, '–°–µ—Å—ñ—è –∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—è —á–µ—Ä–µ–∑ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å')
                    return redirect('login')
            
            request.session['last_activity'] = timezone.now().isoformat()
        
        return self.get_response(request)
```

---

## –í–µ–±-–∞—Ç–∞–∫–∏ —Ç–∞ –∑–∞—Ö–∏—Å—Ç

### üï∑Ô∏è **Cross-Site Scripting (XSS)**

**Django –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞—Ö–∏—Å—Ç, –∞–ª–µ –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏:**

#### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º):**
```html
<!-- Django –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –µ–∫—Ä–∞–Ω—É—î –∫–æ–Ω—Ç–µ–Ω—Ç -->
<p>{{ user_input }}</p>  <!-- –ë–µ–∑–ø–µ—á–Ω–æ -->

<!-- –Ø–∫—â–æ user_input = "<script>alert('XSS')</script>" -->
<!-- Django –≤–∏–≤–µ–¥–µ: &lt;script&gt;alert('XSS')&lt;/script&gt; -->
```

#### **–ù–µ–±–µ–∑–ø–µ—á–Ω–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è:**
```html
<!-- –ù–ï–ë–ï–ó–ü–ï–ß–ù–û - –Ω–µ —Ä–æ–±—ñ—Ç—å —Ç–∞–∫ –±–µ–∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó! -->
<p>{{ user_input|safe }}</p>
<p>{% autoescape off %}{{ user_input }}{% endautoescape %}</p>
```

#### **–ë–µ–∑–ø–µ—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç—É:**
```python
from django.utils.html import strip_tags, escape
from django.utils.safestring import mark_safe
import bleach

def safe_html_content(request):
    user_html = request.POST.get('content')
    
    # –ú–µ—Ç–æ–¥ 1: –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ HTML —Ç–µ–≥–∏
    clean_text = strip_tags(user_html)
    
    # –ú–µ—Ç–æ–¥ 2: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ bleach –¥–ª—è –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤
    allowed_tags = ['p', 'br', 'strong', 'em', 'ul', 'ol', 'li']
    clean_html = bleach.clean(user_html, tags=allowed_tags, strip=True)
    
    # –ú–µ—Ç–æ–¥ 3: –ï–∫—Ä–∞–Ω—É–≤–∞—Ç–∏ HTML
    escaped_html = escape(user_html)
    
    return render(request, 'content.html', {
        'safe_content': mark_safe(clean_html)
    })
```

#### **Content Security Policy (CSP):**
```python
# settings.py
# –î–æ–¥–∞—Ç–∏ CSP middleware
MIDDLEWARE = [
    'csp.middleware.CSPMiddleware',
    # ... —ñ–Ω—à—ñ middleware
]

# CSP –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
CSP_DEFAULT_SRC = ("'self'",)
CSP_SCRIPT_SRC = ("'self'", "'unsafe-inline'")
CSP_STYLE_SRC = ("'self'", "'unsafe-inline'")
CSP_IMG_SRC = ("'self'", "data:", "https:")
CSP_FONT_SRC = ("'self'", "https://fonts.gstatic.com")
```

### üîí **Cross-Site Request Forgery (CSRF)**

#### **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CSRF —Ç–æ–∫–µ–Ω—ñ–≤:**
```html
<!-- Django —Ñ–æ—Ä–º–∞ –∑ CSRF –∑–∞—Ö–∏—Å—Ç–æ–º -->
<form method="post">
    {% csrf_token %}
    <input type="text" name="username">
    <input type="password" name="password">
    <button type="submit">–£–≤—ñ–π—Ç–∏</button>
</form>
```

#### **AJAX –∑–∞–ø–∏—Ç–∏ –∑ CSRF —Ç–æ–∫–µ–Ω–∞–º–∏:**
```javascript
// –û—Ç—Ä–∏–º–∞–Ω–Ω—è CSRF —Ç–æ–∫–µ–Ω—É
function getCSRFToken() {
    return document.querySelector('[name=csrfmiddlewaretoken]').value;
}

// –ê–±–æ –∑ cookies
function getCSRFTokenFromCookie() {
    const cookieValue = document.cookie
        .split('; ')
        .find(row => row.startsWith('csrftoken='))
        ?.split('=')[1];
    return cookieValue;
}

// AJAX –∑–∞–ø–∏—Ç –∑ CSRF —Ç–æ–∫–µ–Ω–æ–º
fetch('/api/update-profile/', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': getCSRFTokenFromCookie(),
    },
    body: JSON.stringify({
        'name': 'New Name',
        'email': 'new@email.com'
    })
})
.then(response => response.json())
.then(data => console.log(data));
```

#### **Vue.js/React —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è:**
```javascript
// Vue.js –ø—Ä–∏–∫–ª–∞–¥
import axios from 'axios';

// –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è axios –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è CSRF —Ç–æ–∫–µ–Ω—É
axios.defaults.xsrfCookieName = 'csrftoken';
axios.defaults.xsrfHeaderName = 'X-CSRFToken';

// React –ø—Ä–∏–∫–ª–∞–¥
const CSRFToken = () => {
    const [csrftoken, setCsrftoken] = useState('');
    
    useEffect(() => {
        const token = document.querySelector('[name=csrfmiddlewaretoken]').value;
        setCsrftoken(token);
    }, []);
    
    return (
        <input type="hidden" name="csrfmiddlewaretoken" value={csrftoken} />
    );
};
```

---

## DEBUG –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### üö® **–ù–µ–±–µ–∑–ø–µ–∫–∞ DEBUG = True –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ:**

**–©–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –ø—Ä–∏ DEBUG = True:**
```python
# –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –¥–æ—Å—Ç—É–ø–Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º:
{
    "url_patterns": [
        "/admin/",
        "/api/users/",
        "/api/payments/",
        "/api/secret-endpoint/"
    ],
    "template_paths": [
        "/app/templates/",
        "/app/secret_templates/"
    ],
    "secret_keys": "django-insecure-your-secret-key-here",
    "database_info": {
        "engine": "postgresql",
        "name": "production_db",
        "host": "db.company.com"
    },
    "installed_apps": [
        "django_extensions",
        "debug_toolbar",
        "payment_processor"
    ]
}
```

### ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è DEBUG:**

#### **–ú–µ—Ç–æ–¥ 1: –†—ñ–∑–Ω—ñ settings —Ñ–∞–π–ª–∏**
```python
# settings/base.py
SECRET_KEY = 'django-insecure-dev-key'
DEBUG = False  # –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º False

# settings/development.py
from .base import *
DEBUG = True
ALLOWED_HOSTS = ['localhost', '127.0.0.1']

# settings/production.py
from .base import *
DEBUG = False
ALLOWED_HOSTS = ['yourdomain.com', 'www.yourdomain.com']
SECRET_KEY = os.environ.get('SECRET_KEY')
```

#### **–ú–µ—Ç–æ–¥ 2: Environment Variables (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π)**
```python
# settings.py
from decouple import config

DEBUG = config('DEBUG', default=False, cast=bool)
SECRET_KEY = config('SECRET_KEY')
ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='').split(',')

# Database
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': config('DB_NAME'),
        'USER': config('DB_USER'),
        'PASSWORD': config('DB_PASSWORD'),
        'HOST': config('DB_HOST', default='localhost'),
        'PORT': config('DB_PORT', default='5432'),
    }
}
```

#### **Environment —Ñ–∞–π–ª (.env):**
```bash
# .env (–¥–æ–¥–∞—Ç–∏ –≤ .gitignore!)
DEBUG=False
SECRET_KEY=your-super-secret-production-key-here
DB_NAME=production_db
DB_USER=prod_user
DB_PASSWORD=super_secure_password
DB_HOST=db.production.com
ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com

# Email settings
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password

# API Keys
PAYSTACK_SECRET_KEY=sk_test_your_paystack_secret
CLOUDINARY_API_KEY=your_cloudinary_key
CLOUDINARY_API_SECRET=your_cloudinary_secret
```

### üõ†Ô∏è **Custom Error Pages:**
```python
# views.py
from django.shortcuts import render

def custom_404(request, exception):
    return render(request, '404.html', status=404)

def custom_500(request):
    return render(request, '500.html', status=500)

# urls.py
handler404 = 'myapp.views.custom_404'
handler500 = 'myapp.views.custom_500'
```

```html
<!-- templates/404.html -->
<!DOCTYPE html>
<html>
<head>
    <title>–°—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞</title>
</head>
<body>
    <div class="error-container">
        <h1>404 - –°—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞</h1>
        <p>–í–∏–±–∞—á—Ç–µ, –∑–∞–ø–∏—Ç—É–≤–∞–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ —ñ—Å–Ω—É—î.</p>
        <a href="{% url 'home' %}">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É</a>
    </div>
</body>
</html>
```

---

## Environment Variables

### üîê **–ß–æ–º—É –Ω–µ —Ç—Ä–µ–±–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –≤ –∫–æ–¥—ñ:**

**–ü–û–ì–ê–ù–û - —Å–µ–∫—Ä–µ—Ç–∏ –≤ settings.py:**
```python
# –ù–ï –†–û–ë–Ü–¢–¨ –¢–ê–ö!
SECRET_KEY = 'django-insecure-hardcoded-key-123'
EMAIL_HOST_PASSWORD = 'myemailpassword123'
PAYSTACK_SECRET_KEY = 'sk_test_abc123def456'
AWS_SECRET_ACCESS_KEY = 'wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY'

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'myproject',
        'USER': 'postgres',
        'PASSWORD': 'mypassword123',  # –°–µ–∫—Ä–µ—Ç –≤ –∫–æ–¥—ñ!
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

### ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è python-decouple:**

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
pip install python-decouple
```

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
```python
# settings.py
from decouple import config, Csv
from django.core.exceptions import ImproperlyConfigured

# Basic settings
DEBUG = config('DEBUG', default=False, cast=bool)
SECRET_KEY = config('SECRET_KEY')

if not SECRET_KEY:
    raise ImproperlyConfigured('SECRET_KEY environment variable is required')

# Database
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': config('DB_NAME'),
        'USER': config('DB_USER'),
        'PASSWORD': config('DB_PASSWORD'),
        'HOST': config('DB_HOST', default='localhost'),
        'PORT': config('DB_PORT', default='5432', cast=int),
    }
}

# Email settings
EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = config('EMAIL_HOST', default='smtp.gmail.com')
EMAIL_PORT = config('EMAIL_PORT', default=587, cast=int)
EMAIL_USE_TLS = config('EMAIL_USE_TLS', default=True, cast=bool)
EMAIL_HOST_USER = config('EMAIL_HOST_USER')
EMAIL_HOST_PASSWORD = config('EMAIL_HOST_PASSWORD')

# API Keys
PAYSTACK_PUBLIC_KEY = config('PAYSTACK_PUBLIC_KEY')
PAYSTACK_SECRET_KEY = config('PAYSTACK_SECRET_KEY')

# Allowed hosts
ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='', cast=Csv())
```

**–í–∞–∂–ª–∏–≤–æ - .gitignore:**
```bash
# .gitignore
.env
.env.local
.env.production
.env.staging
*.env
```

---

## Brute Force –∞—Ç–∞–∫–∏

### üõ°Ô∏è **–ó–∞—Ö–∏—Å—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é django-axes:**

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
```bash
pip install django-axes
```

```python
# settings.py
INSTALLED_APPS = [
    # ...
    'axes',
    # ...
]

MIDDLEWARE = [
    # ...
    'axes.middleware.AxesMiddleware',
    # ...
]

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Axes
AXES_FAILURE_LIMIT = 5  # –ú–∞–∫—Å–∏–º—É–º 5 –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±
AXES_COOLOFF_TIME = 1  # –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ 1 –≥–æ–¥–∏–Ω—É
AXES_LOCK_OUT_BY_COMBINATION_USER_AND_IP = True
AXES_ENABLE_ADMIN = True  # –ó–∞—Ö–∏—Å—Ç–∏—Ç–∏ admin –ø–∞–Ω–µ–ª—å

# –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ cache –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ
AXES_CACHE = 'axes_cache'
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.locmem.LocMemCache',
    },
    'axes_cache': {
        'BACKEND': 'django.core.cache.backends.redis.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
    }
}
```

### ü§ñ **–î–æ–¥–∞–≤–∞–Ω–Ω—è CAPTCHA:**

**django-simple-captcha:**
```bash
pip install django-simple-captcha
```

```python
# forms.py
from django import forms
from captcha.fields import CaptchaField

class LoginForm(forms.Form):
    username = forms.CharField(max_length=150)
    password = forms.CharField(widget=forms.PasswordInput)
    captcha = CaptchaField()

# views.py
def login_view(request):
    if request.method == 'POST':
        form = LoginForm(request.POST)
        if form.is_valid():
            # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ captcha –ø–µ—Ä–µ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é
            username = form.cleaned_data['username']
            password = form.cleaned_data['password']
            
            user = authenticate(request, username=username, password=password)
            if user:
                login(request, user)
                return redirect('dashboard')
    else:
        form = LoginForm()
    
    return render(request, 'login.html', {'form': form})
```

### üîó **–ó–º—ñ–Ω–∞ admin URL:**

**–ü–û–ì–ê–ù–û:**
```python
# urls.py - –ù–ï –†–û–ë–Ü–¢–¨ –¢–ê–ö
urlpatterns = [
    path('admin/', admin.site.urls),  # –õ–µ–≥–∫–æ –∑–¥–æ–≥–∞–¥–∞—Ç–∏—Å—è
    path('backend/', admin.site.urls),  # –¢–µ–∂ –ø–æ–≥–∞–Ω–æ
]
```

**–î–û–ë–†–ï:**
```python
# urls.py
import secrets
from django.conf import settings

# –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π admin URL
ADMIN_URL = getattr(settings, 'ADMIN_URL', f'admin-{secrets.token_urlsafe(16)}/')

urlpatterns = [
    path(ADMIN_URL, admin.site.urls),
    # path('secure-mgmt-portal-xyz789/', admin.site.urls),
]

# settings.py
ADMIN_URL = config('ADMIN_URL', default='admin-a1b2c3d4e5f6/')
```

### üçØ **Honeypot –¥–ª—è admin:**

**django-admin-honeypot:**
```bash
pip install django-admin-honeypot
```

```python
# settings.py
INSTALLED_APPS = [
    # ...
    'admin_honeypot',
    # ...
]

# urls.py
urlpatterns = [
    # –°–ø—Ä–∞–≤–∂–Ω—ñ–π admin –Ω–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–º—É URL
    path('real-admin-xyz789/', admin.site.urls),
    
    # Fake admin (honeypot) –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É URL
    path('admin/', include('admin_honeypot.urls', namespace='admin_honeypot')),
]
```

**–õ–æ–≥—É–≤–∞–Ω–Ω—è —Å–ø—Ä–æ–±:**
```python
# models.py
from admin_honeypot.models import LoginAttempt

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å–ø—Ä–æ–±–∏ –≤—Ö–æ–¥—É
attempts = LoginAttempt.objects.all()
for attempt in attempts:
    print(f"IP: {attempt.ip_address}, Username: {attempt.username}, Time: {attempt.timestamp}")
```

---

## SSL/TLS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### üîí **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è HTTPS –≤ Django:**

```python
# settings.py –¥–ª—è production
# –ü—Ä–∏–º—É—à–µ–Ω–Ω—è HTTPS
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')
SECURE_SSL_REDIRECT = True  # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è HTTP –Ω–∞ HTTPS
SECURE_HSTS_SECONDS = 31536000  # 1 —Ä—ñ–∫
SECURE_HSTS_INCLUDE_SUBDOMAINS = True
SECURE_HSTS_PRELOAD = True

# Secure cookies
SECURE_CONTENT_TYPE_NOSNIFF = True
SECURE_BROWSER_XSS_FILTER = True
SECURE_REFERRER_POLICY = 'strict-origin-when-cross-origin'

# Session security
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
```

### üåê **Nginx –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:**

```nginx
# /etc/nginx/sites-available/myproject
server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;
    return 301 https://$server_name$request_uri;  # –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS
}

server {
    listen 443 ssl http2;
    server_name yourdomain.com www.yourdomain.com;

    # SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ (Let's Encrypt)
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    # SSL –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    add_header X-Frame-Options "DENY" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static/ {
        alias /path/to/your/static/files/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    location /media/ {
        alias /path/to/your/media/files/;
        expires 1y;
        add_header Cache-Control "public";
    }
}
```

---

## Django Security Settings

### üõ°Ô∏è **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏:**

```python
# settings.py - –¥–æ–¥–∞—Ç–∏ –≤ –∫—ñ–Ω–µ—Ü—å —Ñ–∞–π–ª—É
if not DEBUG:
    # Security Middleware
    SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')
    SECURE_SSL_REDIRECT = True
    
    # HSTS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    SECURE_HSTS_SECONDS = 31536000  # 1 —Ä—ñ–∫
    SECURE_HSTS_INCLUDE_SUBDOMAINS = True
    SECURE_HSTS_PRELOAD = True
    
    # Content Security
    SECURE_CONTENT_TYPE_NOSNIFF = True
    SECURE_BROWSER_XSS_FILTER = True
    X_FRAME_OPTIONS = 'DENY'
    SECURE_REFERRER_POLICY = 'strict-origin-when-cross-origin'
    
    # Cookie Security
    SESSION_COOKIE_SECURE = True
    SESSION_COOKIE_HTTPONLY = True
    SESSION_COOKIE_SAMESITE = 'Strict'
    CSRF_COOKIE_SECURE = True
    CSRF_COOKIE_HTTPONLY = True
    CSRF_COOKIE_SAMESITE = 'Strict'
    
    # –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–ø–µ–∫–∏
    SECURE_CROSS_ORIGIN_OPENER_POLICY = 'same-origin'
    
    # Content Security Policy (–ø–æ—Ç—Ä–µ–±—É—î django-csp)
    CSP_DEFAULT_SRC = ("'self'",)
    CSP_SCRIPT_SRC = ("'self'",)
    CSP_STYLE_SRC = ("'self'", "'unsafe-inline'")
    CSP_IMG_SRC = ("'self'", "data:", "https:")
    CSP_FONT_SRC = ("'self'", "https://fonts.gstatic.com")
    CSP_CONNECT_SRC = ("'self'",)
    CSP_FRAME_ANCESTORS = ("'none'",)
```

### ‚ö° **Middleware –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –±–µ–∑–ø–µ–∫–∏:**

```python
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',  # –ü–µ—Ä—à–∏–π!
    'whitenoise.middleware.WhiteNoiseMiddleware',  # –î–ª—è —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
    'corsheaders.middleware.CorsMiddleware',  # CORS
    'csp.middleware.CSPMiddleware',  # CSP
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',  # CSRF
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'axes.middleware.AxesMiddleware',  # Brute force protection
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
    # –í–∞—à—ñ custom middleware –≤ –∫—ñ–Ω—Ü—ñ
]
```

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏

### üí∞ **Fintech —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –∑–∞—Ö–æ–¥–∏:**

#### **Database Row Locking:**
```python
from django.db import transaction
from django.db.models import F

class PaymentService:
    @transaction.atomic
    def transfer_money(self, from_account, to_account, amount):
        # –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ —Ä—è–¥–∫–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
        sender = Account.objects.select_for_update().get(id=from_account.id)
        receiver = Account.objects.select_for_update().get(id=to_account.id)
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–ª–∞–Ω—Å
        if sender.balance < amount:
            raise InsufficientFundsError("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ—à—Ç—ñ–≤")
        
        # –í–∏–∫–æ–Ω–∞—Ç–∏ –ø–µ—Ä–µ–∫–∞–∑ –∞—Ç–æ–º–∞—Ä–Ω–æ
        sender.balance = F('balance') - amount
        receiver.balance = F('balance') + amount
        
        sender.save(update_fields=['balance'])
        receiver.save(update_fields=['balance'])
        
        # –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
        Transaction.objects.create(
            from_account=sender,
            to_account=receiver,
            amount=amount,
            status='completed'
        )
```

#### **Input Validation –¥–ª—è —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π:**
```python
from decimal import Decimal, InvalidOperation
from django import forms

class TransferForm(forms.Form):
    amount = forms.DecimalField(
        max_digits=10,
        decimal_places=2,
        min_value=Decimal('0.01'),  # –ú—ñ–Ω—ñ–º—É–º 1 –∫–æ–ø—ñ–π–∫–∞
        max_value=Decimal('1000000.00')  # –ú–∞–∫—Å–∏–º—É–º 1 –º–ª–Ω
    )
    to_account = forms.CharField(max_length=20)
    description = forms.CharField(max_length=200, required=False)
    
    def clean_amount(self):
        amount = self.cleaned_data['amount']
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (–¥–æ–¥–∞—Ç–∫–æ–≤–∞ –±–µ–∑–ø–µ–∫–∞)
        if amount <= 0:
            raise forms.ValidationError("–°—É–º–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –±—ñ–ª—å—à–µ 0")
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É —Å—É–º—É
        if amount > Decimal('50000.00'):  # –õ—ñ–º—ñ—Ç 50,000
            raise forms.ValidationError("–ü–µ—Ä–µ–≤–∏—â–µ–Ω–æ –ª—ñ–º—ñ—Ç –ø–µ—Ä–µ–∫–∞–∑—É")
        
        return amount
    
    def clean_to_account(self):
        account_number = self.cleaned_data['to_account']
        
        # –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–æ–º–µ—Ä–∞ —Ä–∞—Ö—É–Ω–∫—É
        if not account_number.isdigit():
            raise forms.ValidationError("–ù–æ–º–µ—Ä —Ä–∞—Ö—É–Ω–∫—É –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏")
        
        if len(account_number) != 10:
            raise forms.ValidationError("–ù–æ–º–µ—Ä —Ä–∞—Ö—É–Ω–∫—É –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ 10 —Ü–∏—Ñ—Ä")
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ä–∞—Ö—É–Ω–∫—É
        if not Account.objects.filter(account_number=account_number).exists():
            raise forms.ValidationError("–†–∞—Ö—É–Ω–æ–∫ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        
        return account_number
```

#### **Rate Limiting –¥–ª—è API:**
```python
from django.core.cache import cache
from django.http import JsonResponse
from functools import wraps
import time

def rate_limit(max_requests=5, time_window=60):
    """
    –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –æ–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤
    max_requests: –º–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Ç—ñ–≤
    time_window: —á–∞—Å–æ–≤–µ –≤—ñ–∫–Ω–æ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    """
    def decorator(view_func):
        @wraps(view_func)
        def wrapper(request, *args, **kwargs):
            # –ö–ª—é—á –¥–ª—è cache –Ω–∞ –æ—Å–Ω–æ–≤—ñ IP —Ç–∞ view
            cache_key = f"rate_limit:{request.META.get('REMOTE_ADDR')}:{view_func.__name__}"
            
            # –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
            current_requests = cache.get(cache_key, 0)
            
            if current_requests >= max_requests:
                return JsonResponse({
                    'error': 'Rate limit exceeded',
                    'detail': f'Maximum {max_requests} requests per {time_window} seconds'
                }, status=429)
            
            # –ó–±—ñ–ª—å—à–∏—Ç–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫
            cache.set(cache_key, current_requests + 1, time_window)
            
            return view_func(request, *args, **kwargs)
        return wrapper
    return decorator

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
@rate_limit(max_requests=3, time_window=300)  # 3 –∑–∞–ø–∏—Ç–∏ –∑–∞ 5 —Ö–≤–∏–ª–∏–Ω
def transfer_money_api(request):
    if request.method == 'POST':
        form = TransferForm(request.POST)
        if form.is_valid():
            # –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–∫–∞–∑—É
            pass
    return JsonResponse({'status': 'success'})
```

### üîç **Audit Logging:**
```python
import logging
from django.contrib.auth.signals import user_logged_in, user_logged_out, user_login_failed
from django.dispatch import receiver

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è security logger
security_logger = logging.getLogger('security')

class SecurityAuditMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        # –õ–æ–≥—É–≤–∞—Ç–∏ –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ –∑–∞–ø–∏—Ç–∏
        if self.is_suspicious_request(request):
            security_logger.warning(
                f"Suspicious request from {request.META.get('REMOTE_ADDR')}: "
                f"{request.method} {request.path}"
            )
        
        response = self.get_response(request)
        return response
    
    def is_suspicious_request(self, request):
        suspicious_patterns = [
            '/admin/',
            '/wp-admin/',
            '/.env',
            '/api/admin',
            'eval(',
            '<script',
            'union select',
            'drop table'
        ]
        
        path = request.path.lower()
        query = request.META.get('QUERY_STRING', '').lower()
        
        return any(pattern in path or pattern in query for pattern in suspicious_patterns)

# Signal handlers –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
@receiver(user_logged_in)
def log_user_login(sender, request, user, **kwargs):
    security_logger.info(
        f"User login: {user.username} from {request.META.get('REMOTE_ADDR')}"
    )

@receiver(user_logged_out)
def log_user_logout(sender, request, user, **kwargs):
    security_logger.info(
        f"User logout: {user.username} from {request.META.get('REMOTE_ADDR')}"
    )

@receiver(user_login_failed)
def log_login_failure(sender, credentials, request, **kwargs):
    security_logger.warning(
        f"Failed login attempt: {credentials.get('username')} "
        f"from {request.META.get('REMOTE_ADDR')}"
    )
```

### üåê **DDoS Protection –∑ Cloudflare:**

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Cloudflare –≤ Django:**
```python
# settings.py
# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Cloudflare
SECURE_PROXY_SSL_HEADER = ('HTTP_CF_VISITOR', '{"scheme":"https"}')

# Middleware –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö IP –∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ Cloudflare
class CloudflareMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response
    
    def __call__(self, request):
        # Cloudflare –ø–µ—Ä–µ–¥–∞—î —Å–ø—Ä–∞–≤–∂–Ω—ñ–π IP –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É CF-Connecting-IP
        cf_connecting_ip = request.META.get('HTTP_CF_CONNECTING_IP')
        if cf_connecting_ip:
            request.META['REMOTE_ADDR'] = cf_connecting_ip
        
        return self.get_response(request)

# –î–æ–¥–∞—Ç–∏ –¥–æ MIDDLEWARE
MIDDLEWARE = [
    'myapp.middleware.CloudflareMiddleware',
    # ... —ñ–Ω—à—ñ middleware
]
```

---

## Security Checklist

### ‚úÖ **Deployment Security Checklist:**

```python
# checklist.py - –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
import os
import sys
from django.conf import settings

class SecurityChecker:
    def __init__(self):
        self.errors = []
        self.warnings = []
        self.passed = []
    
    def check_debug_setting(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ DEBUG = False –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ"""
        if getattr(settings, 'DEBUG', True):
            self.errors.append("‚ùå DEBUG = True (CRITICAL: Must be False in production)")
        else:
            self.passed.append("‚úÖ DEBUG = False")
    
    def check_secret_key(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ SECRET_KEY"""
        secret_key = getattr(settings, 'SECRET_KEY', '')
        
        if not secret_key:
            self.errors.append("‚ùå SECRET_KEY is empty")
        elif 'django-insecure' in secret_key:
            self.errors.append("‚ùå Using default insecure SECRET_KEY")
        elif len(secret_key) < 50:
            self.warnings.append("‚ö†Ô∏è SECRET_KEY is too short (should be 50+ chars)")
        else:
            self.passed.append("‚úÖ SECRET_KEY is properly configured")
    
    def check_allowed_hosts(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ ALLOWED_HOSTS"""
        allowed_hosts = getattr(settings, 'ALLOWED_HOSTS', [])
        
        if not allowed_hosts or '*' in allowed_hosts:
            self.errors.append("‚ùå ALLOWED_HOSTS is not properly configured")
        else:
            self.passed.append("‚úÖ ALLOWED_HOSTS is configured")
    
    def check_https_settings(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ HTTPS –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        https_checks = [
            ('SECURE_SSL_REDIRECT', True),
            ('SECURE_HSTS_SECONDS', lambda x: x > 0),
            ('SESSION_COOKIE_SECURE', True),
            ('CSRF_COOKIE_SECURE', True),
        ]
        
        for setting_name, expected in https_checks:
            value = getattr(settings, setting_name, None)
            if callable(expected):
                if not expected(value):
                    self.warnings.append(f"‚ö†Ô∏è {setting_name} should be properly configured")
                else:
                    self.passed.append(f"‚úÖ {setting_name} is configured")
            elif value != expected:
                self.warnings.append(f"‚ö†Ô∏è {setting_name} should be {expected}")
            else:
                self.passed.append(f"‚úÖ {setting_name} = {expected}")
    
    def check_csrf_protection(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ CSRF –∑–∞—Ö–∏—Å—Ç"""
        middleware = getattr(settings, 'MIDDLEWARE', [])
        
        if 'django.middleware.csrf.CsrfViewMiddleware' not in middleware:
            self.errors.append("‚ùå CSRF middleware is not enabled")
        else:
            self.passed.append("‚úÖ CSRF protection is enabled")
    
    def check_security_middleware(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ security middleware"""
        middleware = getattr(settings, 'MIDDLEWARE', [])
        
        required_middleware = [
            'django.middleware.security.SecurityMiddleware',
            'django.middleware.clickjacking.XFrameOptionsMiddleware',
        ]
        
        for mw in required_middleware:
            if mw not in middleware:
                self.warnings.append(f"‚ö†Ô∏è {mw} should be in MIDDLEWARE")
            else:
                self.passed.append(f"‚úÖ {mw} is enabled")
    
    def check_database_security(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö"""
        databases = getattr(settings, 'DATABASES', {})
        default_db = databases.get('default', {})
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è SQLite –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ
        if default_db.get('ENGINE') == 'django.db.backends.sqlite3':
            self.warnings.append("‚ö†Ô∏è Using SQLite in production (consider PostgreSQL)")
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–∞—Ä–æ–ª—å –Ω–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
        password = default_db.get('PASSWORD', '')
        if not password or password in ['password', '123456', 'admin']:
            self.errors.append("‚ùå Database password is weak or missing")
        else:
            self.passed.append("‚úÖ Database password is configured")
    
    def run_all_checks(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏"""
        self.check_debug_setting()
        self.check_secret_key()
        self.check_allowed_hosts()
        self.check_https_settings()
        self.check_csrf_protection()
        self.check_security_middleware()
        self.check_database_security()
        
        return self.generate_report()
    
    def generate_report(self):
        """–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑–≤—ñ—Ç"""
        print("\n" + "="*60)
        print("üîí DJANGO SECURITY AUDIT REPORT")
        print("="*60)
        
        if self.errors:
            print(f"\nüö® CRITICAL ISSUES ({len(self.errors)}):")
            for error in self.errors:
                print(f"  {error}")
        
        if self.warnings:
            print(f"\n‚ö†Ô∏è WARNINGS ({len(self.warnings)}):")
            for warning in self.warnings:
                print(f"  {warning}")
        
        if self.passed:
            print(f"\n‚úÖ PASSED CHECKS ({len(self.passed)}):")
            for check in self.passed:
                print(f"  {check}")
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
        print(f"\nüìã SECURITY SCORE: {len(self.passed)}/{len(self.passed) + len(self.warnings) + len(self.errors)}")
        
        if self.errors:
            print("\nüö® ACTION REQUIRED: Fix critical issues before deployment!")
            return False
        elif self.warnings:
            print("\n‚ö†Ô∏è REVIEW RECOMMENDED: Address warnings for better security")
            return True
        else:
            print("\nüéâ EXCELLENT: All security checks passed!")
            return True

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
if __name__ == "__main__":
    import django
    django.setup()
    
    checker = SecurityChecker()
    success = checker.run_all_checks()
    
    sys.exit(0 if success else 1)
```

### üìã **Manual Deployment Checklist:**

```markdown
# üîí Django Production Deployment Security Checklist

## ‚úÖ Basic Security
- [ ] DEBUG = False
- [ ] SECRET_KEY from environment variable
- [ ] ALLOWED_HOSTS properly configured
- [ ] .env file in .gitignore
- [ ] No hardcoded secrets in code

## üîê Authentication & Authorization
- [ ] Strong password validation enabled
- [ ] User roles and permissions configured
- [ ] Admin URL changed from default
- [ ] Two-factor authentication (if needed)
- [ ] Session timeout configured

## üõ°Ô∏è Web Security
- [ ] CSRF protection enabled
- [ ] XSS protection configured
- [ ] HTTPS enforced (SSL redirect)
- [ ] Security headers configured
- [ ] HSTS enabled
- [ ] Content Security Policy (if needed)

## üåê Network Security
- [ ] SSL certificate installed and valid
- [ ] Cloudflare or CDN configured
- [ ] Firewall rules configured
- [ ] Database not accessible from internet
- [ ] Admin panel IP restricted (if needed)

## üìä Monitoring & Logging
- [ ] Security logging enabled
- [ ] Error logging configured
- [ ] Log rotation configured
- [ ] Security alerts configured
- [ ] Backup strategy implemented

## üîß Additional Security
- [ ] django-axes for brute force protection
- [ ] Rate limiting implemented
- [ ] Input validation on all forms
- [ ] File upload restrictions
- [ ] Database connection encryption

## üöÄ Performance & Availability
- [ ] Static files served efficiently
- [ ] Database optimized
- [ ] Caching configured
- [ ] Load balancing (if needed)
- [ ] Health checks configured

## üì± API Security (if applicable)
- [ ] API authentication implemented
- [ ] API rate limiting
- [ ] CORS properly configured
- [ ] API versioning strategy
- [ ] API documentation security reviewed
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–Ω—è

### üéØ **–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ Django Security:**

1. **Security by Default** - Django –º–∞—î —á—É–¥–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∞–ª–µ —ó—Ö —Ç—Ä–µ–±–∞ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏
2. **Defense in Depth** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫—ñ–ª—å–∫–∞ —Ä—ñ–≤–Ω—ñ–≤ –∑–∞—Ö–∏—Å—Ç—É
3. **Principle of Least Privilege** - –Ω–∞–¥–∞–≤–∞–π—Ç–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø—Ä–∞–≤–∞
4. **Regular Security Audits** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

### üìö **–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ –ø–∞–∫–µ—Ç–∏:**
```bash
# –û—Å–Ω–æ–≤–Ω—ñ security –ø–∞–∫–µ—Ç–∏
pip install python-decouple
pip install django-axes
pip install django-csp
pip install django-simple-captcha
pip install django-admin-honeypot

# –î–ª—è API
pip install djangorestframework
pip install django-cors-headers
pip install django-oauth-toolkit

# –î–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
pip install django-extensions
pip install django-debug-toolbar  # –¢—ñ–ª—å–∫–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏!
```

### üîÑ **Security Maintenance:**
- **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ Django** —Ç–∞ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
- **–ú–æ–Ω—ñ—Ç–æ—Ä—å—Ç–µ CVE** –¥–ª—è Django —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
- **–ü—Ä–æ–≤–æ–¥—å—Ç–µ security audits** –ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–∏–º —Ä–µ–ª—ñ–∑–æ–º
- **–ù–∞–≤—á–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É** –∫—Ä–∞—â–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –±–µ–∑–ø–µ–∫–∏

### üí° **–ü–∞–º'—è—Ç–∞–π—Ç–µ:**
> "–ë–µ–∑–ø–µ–∫–∞ - —Ü–µ –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞ –∑–∞–¥–∞—á–∞, –∞ –ø–æ—Å—Ç—ñ–π–Ω–∏–π –ø—Ä–æ—Ü–µ—Å. –ö–æ–∂–µ–Ω –Ω–æ–≤–∏–π feature –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Ç–æ–º—É –±–µ–∑–ø–µ–∫–∞ –º–∞—î –±—É—Ç–∏ —á–∞—Å—Ç–∏–Ω–æ—é –≤–∞—à–æ—ó –∫—É–ª—å—Ç—É—Ä–∏ —Ä–æ–∑—Ä–æ–±–∫–∏."

**–ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ –ø—Ä–∞–≤–∏–ª–æ:** –ù—ñ–∫–æ–ª–∏ –Ω–µ –∂–µ—Ä—Ç–≤—É–π—Ç–µ –±–µ–∑–ø–µ–∫–æ—é –∑–∞—Ä–∞–¥–∏ —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ä–æ–∑—Ä–æ–±–∫–∏. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è security breach –∫–æ—à—Ç—É—î –Ω–∞–±–∞–≥–∞—Ç–æ –¥–æ—Ä–æ–∂—á–µ, –Ω—ñ–∂ –π–æ–≥–æ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è.




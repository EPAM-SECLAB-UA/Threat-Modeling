

- Getting started with the Threat Modeling Tool, https://learn.microsoft.com/en-us/azure/security/develop/threat-modeling-tool-getting-started

  # Початок роботи з Інструментом Моделювання Загроз

**08/25/2022**

Microsoft Threat Modeling Tool 2018 був випущений як GA у вересні 2018 року як безкоштовний інструмент для завантаження. Зміна в механізмі поставки дозволяє нам передавати останні покращення та виправлення помилок клієнтам кожного разу, коли вони відкривають інструмент, що робить його простішим у підтримці та використанні. Ця стаття проводить вас через процес початку роботи з підходом Microsoft SDL threat modeling і показує, як використовувати інструмент для розробки чудових моделей загроз як основи вашого процесу безпеки.

Ця стаття базується на існуючих знаннях підходу SDL threat modeling. Для швидкого огляду зверніться до Threat Modeling Web Applications та архівної версії статті MSDN "Uncover Security Flaws Using the STRIDE Approach", опублікованої в 2006 році.

Коротко підсумовуючи, підхід включає створення діаграми, ідентифікацію загроз, їх пом'якшення та валідацію кожного пом'якшення. Ось діаграма, яка висвітлює цей процес:

**SDL Процес**

## Початок процесу моделювання загроз

Коли ви запускаєте Threat Modeling Tool, ви помітите кілька речей, як видно на картинці:

**Пуста Стартова Сторінка**

### Секція моделі загроз

| Компонент | Деталі |
|-----------|--------|
| Кнопка зворотного зв'язку, пропозицій та проблем | Переводить вас на MSDN форум для всіх питань SDL. Дає вам можливість прочитати, що роблять інші користувачі, разом з обхідними шляхами та рекомендаціями. Якщо ви все ще не можете знайти те, що шукаєте, напишіть на tmtextsupport@microsoft.com для нашої команди підтримки |
| Створити Модель | Відкриває порожнє полотно для малювання вашої діаграми. Переконайтеся, що вибрали шаблон, який хочете використовувати для вашої моделі |
| Шаблон для Нових Моделей | Ви повинні вибрати шаблон перед створенням моделі. Наш основний шаблон - це Azure Threat Model Template, який містить Azure-специфічні трафарети, загрози та пом'якшення. Для загальних моделей виберіть SDL TM Knowledge Base з випадаючого меню. Хочете створити власний шаблон або подати новий для всіх користувачів? Перевірте нашу Template Repository GitHub Page для більш детальної інформації |
| Відкрити Модель | Відкриває раніше збережені моделі загроз. Функція Recently Opened Models чудова, якщо вам потрібно відкрити ваші найновіші файли. Коли ви наводите на вибір, ви знайдете 2 способи відкрити моделі:<br>• Open From this Computer – класичний спосіб відкриття файлу з локального сховища<br>• Open from OneDrive – команди можуть використовувати папки в OneDrive для збереження та спільного використання всіх їхніх моделей загроз в одному місці для підвищення продуктивності та співпраці |
| Керівництво з Початку Роботи | Відкриває головну сторінку Microsoft Threat Modeling Tool |

### Секція шаблонів

| Компонент | Деталі |
|-----------|--------|
| Створити Новий Шаблон | Відкриває порожній шаблон для розробки. Якщо у вас немає обширних знань у створенні шаблонів з нуля, ми рекомендуємо будувати на основі існуючих |
| Відкрити Шаблон | Відкриває існуючі шаблони для внесення змін |

Команда Threat Modeling Tool постійно працює над покращенням функціональності та досвіду інструменту. Кілька незначних змін можуть відбутися протягом року, але всі основні зміни потребують перепису в керівництві. Зверніться до нього часто, щоб переконатися, що ви отримуєте останні оголошення.

## Створення моделі

У цій секції ми слідуємо за:

- **Крістіна** (розробник)
- **Рікардо** (менеджер програми) та
- **Ашіш** (тестувальник)

Вони проходять процес розробки своєї першої моделі загроз.

**Рікардо:** Привіт, Крістіно, я працював над діаграмою моделі загроз і хотів переконатися, що ми правильно зрозуміли деталі. Можеш допомогти мені переглянути це?

**Крістіна:** Абсолютно. Давайте подивимося.

Рікардо відкриває інструмент і ділиться своїм екраном з Крістіною.

**Базова Модель Загроз**

**Крістіна:** Окей, виглядає прямолінійно, але можеш провести мене через це?

**Рікардо:** Звичайно! Ось розбивка:

- Наш людський користувач намальований як зовнішня сутність — квадрат
- Вони надсилають команди нашому Web серверу — коло  
- Web сервер консультується з базою даних (два паралельні лінії)

Те, що Рікардо щойно показав Крістіні, це DFD, скорочення від Data Flow Diagram. Threat Modeling Tool дозволяє користувачам вказувати межі довіри, позначені червоними пунктирними лініями, щоб показати, де різні сутності мають контроль. Наприклад, ІТ адміністраторам потрібна система Active Directory для аутентифікації, тому Active Directory знаходиться поза їхнім контролем.

**Крістіна:** Виглядає правильно для мене. А що з загрозами?

**Рікардо:** Дозволь показати тобі.

## Аналіз загроз

Коли він натискає на вигляд аналізу з меню іконок (файл з лупою), його переводить до списку згенерованих загроз, які Threat Modeling Tool знайшов на основі шаблону за замовчуванням, який використовує підхід SDL під назвою STRIDE (Spoofing, Tampering, Repudiation, Info Disclosure, Denial of Service та Elevation of Privilege). Ідея полягає в тому, що програмне забезпечення піддається передбачуваному набору загроз, які можна знайти, використовуючи ці 6 категорій.

Цей підхід схожий на захист вашого будинку шляхом забезпечення того, щоб кожні двері та вікно мали замковий механізм перед додаванням сигналізації або переслідуванням злодія.

**Базові Загрози**

Рікардо починає з вибору першого елемента в списку. Ось що відбувається:

По-перше, взаємодія між двома трафаретами посилюється

*Скріншот показує два трафарети та криву стрілку, що їх з'єднує, більш жирною лінією.*

По-друге, додаткова інформація про загрозу з'являється у вікні Threat Properties

*Скріншот показує вікно Threat Properties, яке містить Title, Category, Description, Interaction та Priority.*

Згенерована загроза допомагає йому зрозуміти потенційні недоліки дизайну. Категоризація STRIDE дає йому уявлення про потенційні вектори атак, тоді як додатковий опис точно говорить йому, що не так, разом з потенційними способами пом'якшення. Він може використовувати редаговані поля для написання заміток в деталях обґрунтування або зміни рейтингів пріоритету залежно від bug bar його організації.

Azure шаблони мають додаткові деталі, щоб допомогти користувачам зрозуміти не тільки що не так, але також як це виправити, додаючи описи, приклади та гіперпосилання на Azure-специфічну документацію.

Опис змусив його усвідомити важливість додавання механізму аутентифікації для запобігання підміні користувачів, розкриваючи першу загрозу для роботи. За кілька хвилин обговорення з Крістіною вони зрозуміли важливість впровадження контролю доступу та ролей. Рікардо заповнив кілька швидких заміток, щоб переконатися, що вони були впроваджені.

Коли Рікардо перейшов до загроз під Information Disclosure, він зрозумів, що план контролю доступу потребував деяких read-only облікових записів для аудиту та генерації звітів. Він задався питанням, чи повинно це бути новою загрозою, але пом'якшення були такими ж, тому він відзначив загрозу відповідно. Він також подумав про розкриття інформації трохи більше і зрозумів, що резервні стрічки потребуватимуть шифрування — робота для команди операцій.

Загрози, що не застосовуються до дизайну через існуючі пом'якшення або гарантії безпеки, можуть бути змінені на "Not Applicable" з випадаючого списку Status. Є три інші варіанти: Not Started – вибір за замовчуванням, Needs Investigation – використовується для подальшого вивчення елементів та Mitigated – коли над цим повністю попрацювали.

## Звіти та спільне використання

Коли Рікардо проходить список з Крістіною і додає важливі замітки, пом'якшення/обґрунтування, пріоритет та зміни статусу, він вибирає Reports -> Create Full Report -> Save Report, що друкує гарний звіт для нього, щоб пройти з колегами для забезпечення впровадження належної роботи з безпеки.

*Скріншот показує репрезентативний Threat Modeling Report.*

Якщо Рікардо хоче поділитися файлом замість цього, він може легко зробити це, зберігши в OneDrive акаунті своєї організації. Коли він це робить, він може скопіювати посилання на документ і поділитися ним зі своїми колегами.

## Зустрічі з моделювання загроз

Коли Рікардо надіслав свою модель загроз своєму колезі, використовуючи OneDrive, Ашіш, тестувальник, був не вражений. Здавалося, що Рікардо та Крістіна пропустили досить багато важливих граничних випадків, які могли бути легко скомпрометовані. Його скептицизм є доповненням до моделей загроз.

У цьому сценарії, після того як Ашіш взяв на себе модель загроз, він скликав дві зустрічі з моделювання загроз: одну зустріч для синхронізації процесу та проходження діаграм, а потім другу зустріч для перегляду загроз та схвалення.

На першій зустрічі Ашіш витратив 10 хвилин, проводячи всіх через процес SDL threat modeling. Потім він відкрив діаграму моделі загроз і почав детально її пояснювати. За п'ять хвилин був ідентифікований важливий відсутній компонент.

Кілька хвилин потому Ашіш і Рікардо ввійшли в розширене обговорення того, як був побудований Web сервер. Це був не ідеальний спосіб проведення зустрічі, але всі зрештою погодилися, що виявлення розбіжності рано заощадить їм час у майбутньому.

На другій зустрічі команда пройшла через загрози, обговорила деякі способи їх вирішення та схвалила модель загроз. Вони перевірили документ в систему контролю версій і продовжили з розробкою.

## Думаючи про активи

Деякі читачі, які моделювали загрози, можуть помітити, що ми взагалі не говорили про активи. Ми виявили, що багато інженерів-програмістів розуміють своє програмне забезпечення краще, ніж розуміють концепцію активів і якими активами може бути зацікавлений зловмисник.

Якщо ви збираєтеся моделювати загрози будинку, ви можете почати з думки про вашу сім'ю, незамінні фотографії або цінні твори мистецтва. Можливо, ви почнете з думки про те, хто може вломитися, та поточну систему безпеки. Або ви можете почати з розгляду фізичних особливостей, таких як басейн або передній ганок. Це аналогічно думці про активи, зловмисників або дизайн програмного забезпечення. Будь-який з цих трьох підходів працює.

Підхід до моделювання загроз, який ми представили тут, значно простіший, ніж те, що Microsoft робив у минулому. Ми виявили, що підхід дизайну програмного забезпечення добре працює для багатьох команд. Ми сподіваємося, що це включає і вашу.

## Наступні кроки

Надсилайте ваші запитання, коментарі та занепокоєння на tmtextsupport@microsoft.com. Завантажте Threat Modeling Tool, щоб почати.
